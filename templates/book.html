{% extends 'base.html' %}
{% block body %}
<div class="row mb-12">
    <div class="col-md-4 mb-8">
        <img src="{{ book.coverURL }}" alt="Cover Image" class="card-img-top" style="width:55%;margin-left: 150px;"/>
    </div>
    <div class="col-md-8 mb-8" style="margin-top: 50px;">
        <h1 id="title">{{ book.title }}</h1>
        <p id="content">{{ book.description }}</p>
    </div>
</div>

<!-- Submit Review Form for Logged-In Users -->
{% if session.get('email') %}
    <h2>Submit Your Review</h2>
    <div class="form-container">
        <form method="POST" action="{{ url_for('submit_review', book_id=book.id) }}">
            <!-- CSRF Token -->
            {{ form.hidden_tag() }}
            
            <div class="form-group">
                <label for="ratings">Rating (1-5):</label>
                <select id="ratings" name="ratings" required>
                    <option value="" disabled selected>Select your rating</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </div>
            <div class="form-group">
                <label for="content">Comment:</label>
                <textarea id="content" name="content" rows="4" required></textarea>
            </div>
            <button type="submit">Submit Review</button>
        </form>
    </div>
{% else %}
    <div class="centered-text">
        <p>Please <a href="{{ url_for('login') }}">log in</a> to submit a review.</p>
    </div>
{% endif %}


<!-- Display Reviews -->
<div class="col-md-12 mb-12">
    <h2>Reviews</h2>
    {% for review in reviews %}
        <div class="review-card">
            <h3>{{ review.first_name }} {{ review.last_name }}</h3>
            <p>Rating: {{ review.ratings }}/5</p>
            <p>{{ review.content }}</p>
        </div>
    {% endfor %}
</div>

{% endblock %}
